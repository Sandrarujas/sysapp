{"ast":null,"code":"\"use client\";import{useState,useEffect}from\"react\";import{useLocation,Link}from\"react-router-dom\";import axios from\"axios\";import Post from\"../components/Post\";import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const Search=()=>{const location=useLocation();const searchParams=new URLSearchParams(location.search);const query=searchParams.get(\"q\")||\"\";const[activeTab,setActiveTab]=useState(\"users\");const[users,setUsers]=useState([]);const[posts,setPosts]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(\"\");useEffect(()=>{const fetchSearchResults=async()=>{if(!query){setLoading(false);return;}setLoading(true);setError(\"\");try{if(activeTab===\"users\"){const res=await axios.get(`http://localhost:5000/api/search/users?q=${query}`);setUsers(res.data);}else{const res=await axios.get(`http://localhost:5000/api/search/posts?q=${query}`);setPosts(res.data);}setLoading(false);}catch(error){console.error(\"Error en búsqueda:\",error);setError(\"Error al realizar la búsqueda\");setLoading(false);}};fetchSearchResults();},[query,activeTab]);const handleFollow=async(userId,isFollowing,index)=>{try{if(isFollowing){await axios.delete(`http://localhost:5000/api/users/${userId}/unfollow`);}else{await axios.post(`http://localhost:5000/api/users/${userId}/follow`);}// Actualizar estado local\nconst updatedUsers=[...users];updatedUsers[index].isFollowing=!isFollowing;setUsers(updatedUsers);}catch(error){console.error(\"Error al seguir/dejar de seguir:\",error);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"search-container\",children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"Resultados de b\\xFAsqueda: \\\"\",query,\"\\\"\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-tabs\",children:[/*#__PURE__*/_jsx(\"button\",{className:`tab-button ${activeTab===\"users\"?\"active\":\"\"}`,onClick:()=>setActiveTab(\"users\"),children:\"Usuarios\"}),/*#__PURE__*/_jsx(\"button\",{className:`tab-button ${activeTab===\"posts\"?\"active\":\"\"}`,onClick:()=>setActiveTab(\"posts\"),children:\"Publicaciones\"})]}),loading?/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Buscando...\"}):error?/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:error}):activeTab===\"users\"?/*#__PURE__*/_jsx(\"div\",{className:\"users-results\",children:users.length>0?users.map((user,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"user-card\",children:[/*#__PURE__*/_jsxs(Link,{to:`/profile/${user.username}`,className:\"user-info\",children:[/*#__PURE__*/_jsx(\"img\",{src:user.profileImage?`http://localhost:5000${user.profileImage}`:\"/placeholder.svg?height=50&width=50\",alt:user.username,className:\"user-image\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-details\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"user-username\",children:user.username}),/*#__PURE__*/_jsx(\"p\",{className:\"user-bio\",children:user.bio||\"Sin biografía\"})]})]}),/*#__PURE__*/_jsx(\"button\",{className:`follow-button ${user.isFollowing?\"following\":\"\"}`,onClick:()=>handleFollow(user.id,user.isFollowing,index),children:user.isFollowing?\"Dejar de Seguir\":\"Seguir\"})]},user.id)):/*#__PURE__*/_jsxs(\"p\",{className:\"no-results\",children:[\"No se encontraron usuarios con \\\"\",query,\"\\\"\"]})}):/*#__PURE__*/_jsx(\"div\",{className:\"posts-results\",children:posts.length>0?posts.map(post=>/*#__PURE__*/_jsx(Post,{post:post},post.id)):/*#__PURE__*/_jsxs(\"p\",{className:\"no-results\",children:[\"No se encontraron publicaciones con \\\"\",query,\"\\\"\"]})})]});};export default Search;","map":{"version":3,"names":["useState","useEffect","useLocation","Link","axios","Post","jsxs","_jsxs","jsx","_jsx","Search","location","searchParams","URLSearchParams","search","query","get","activeTab","setActiveTab","users","setUsers","posts","setPosts","loading","setLoading","error","setError","fetchSearchResults","res","data","console","handleFollow","userId","isFollowing","index","delete","post","updatedUsers","className","children","onClick","length","map","user","to","username","src","profileImage","alt","bio","id"],"sources":["C:/Users/34615/Desktop/TFC_sys/ProyectoFinal_sys/client/src/pages/Search.jsx"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect } from \"react\"\nimport { useLocation, Link } from \"react-router-dom\"\nimport axios from \"axios\"\nimport Post from \"../components/Post\"\n\nconst Search = () => {\n  const location = useLocation()\n  const searchParams = new URLSearchParams(location.search)\n  const query = searchParams.get(\"q\") || \"\"\n\n  const [activeTab, setActiveTab] = useState(\"users\")\n  const [users, setUsers] = useState([])\n  const [posts, setPosts] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState(\"\")\n\n  useEffect(() => {\n    const fetchSearchResults = async () => {\n      if (!query) {\n        setLoading(false)\n        return\n      }\n\n      setLoading(true)\n      setError(\"\")\n\n      try {\n        if (activeTab === \"users\") {\n          const res = await axios.get(`http://localhost:5000/api/search/users?q=${query}`)\n          setUsers(res.data)\n        } else {\n          const res = await axios.get(`http://localhost:5000/api/search/posts?q=${query}`)\n          setPosts(res.data)\n        }\n        setLoading(false)\n      } catch (error) {\n        console.error(\"Error en búsqueda:\", error)\n        setError(\"Error al realizar la búsqueda\")\n        setLoading(false)\n      }\n    }\n\n    fetchSearchResults()\n  }, [query, activeTab])\n\n  const handleFollow = async (userId, isFollowing, index) => {\n    try {\n      if (isFollowing) {\n        await axios.delete(`http://localhost:5000/api/users/${userId}/unfollow`)\n      } else {\n        await axios.post(`http://localhost:5000/api/users/${userId}/follow`)\n      }\n\n      // Actualizar estado local\n      const updatedUsers = [...users]\n      updatedUsers[index].isFollowing = !isFollowing\n      setUsers(updatedUsers)\n    } catch (error) {\n      console.error(\"Error al seguir/dejar de seguir:\", error)\n    }\n  }\n\n  return (\n    <div className=\"search-container\">\n      <h1>Resultados de búsqueda: \"{query}\"</h1>\n\n      <div className=\"search-tabs\">\n        <button className={`tab-button ${activeTab === \"users\" ? \"active\" : \"\"}`} onClick={() => setActiveTab(\"users\")}>\n          Usuarios\n        </button>\n        <button className={`tab-button ${activeTab === \"posts\" ? \"active\" : \"\"}`} onClick={() => setActiveTab(\"posts\")}>\n          Publicaciones\n        </button>\n      </div>\n\n      {loading ? (\n        <div className=\"loading\">Buscando...</div>\n      ) : error ? (\n        <div className=\"error\">{error}</div>\n      ) : activeTab === \"users\" ? (\n        <div className=\"users-results\">\n          {users.length > 0 ? (\n            users.map((user, index) => (\n              <div key={user.id} className=\"user-card\">\n                <Link to={`/profile/${user.username}`} className=\"user-info\">\n                  <img\n                    src={user.profileImage ? `http://localhost:5000${user.profileImage}` : \"/placeholder.svg?height=50&width=50\"}\n                    alt={user.username}\n                    className=\"user-image\"\n                  />\n                  <div className=\"user-details\">\n                    <h3 className=\"user-username\">{user.username}</h3>\n                    <p className=\"user-bio\">{user.bio || \"Sin biografía\"}</p>\n                  </div>\n                </Link>\n                <button\n                  className={`follow-button ${user.isFollowing ? \"following\" : \"\"}`}\n                  onClick={() => handleFollow(user.id, user.isFollowing, index)}\n                >\n                  {user.isFollowing ? \"Dejar de Seguir\" : \"Seguir\"}\n                </button>\n              </div>\n            ))\n          ) : (\n            <p className=\"no-results\">No se encontraron usuarios con \"{query}\"</p>\n          )}\n        </div>\n      ) : (\n        <div className=\"posts-results\">\n          {posts.length > 0 ? (\n            posts.map((post) => <Post key={post.id} post={post} />)\n          ) : (\n            <p className=\"no-results\">No se encontraron publicaciones con \"{query}\"</p>\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n\nexport default Search\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}