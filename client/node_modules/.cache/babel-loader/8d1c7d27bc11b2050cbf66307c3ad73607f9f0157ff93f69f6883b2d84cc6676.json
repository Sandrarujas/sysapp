{"ast":null,"code":"\"use client\";import{useState,useEffect,useContext}from\"react\";import axios from\"axios\";import{useAuth}from\"../context/AuthContext\";import{AuthContext}from\"../context/AuthContext\";import Post from\"../components/Post\";import styles from\"../styles/Home.module.css\";// ⬅️ Importamos el módulo CSS\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Home=()=>{const{updatePost,deletePost:deletePostFromContext}=useContext(AuthContext);const{user}=useAuth();const[posts,setPosts]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(\"\");const[page,setPage]=useState(1);const[pagination,setPagination]=useState({page:1,limit:5,total:0,totalPages:0});useEffect(()=>{const fetchPosts=async()=>{try{setLoading(true);const res=await axios.get(`http://localhost:5000/api/posts?page=${page}&limit=5`);setPosts(res.data.posts);setPagination(res.data.pagination);setLoading(false);}catch(error){console.error(\"Error fetching posts:\",error);setError(\"Error al cargar las publicaciones\");setLoading(false);}};fetchPosts();},[page]);const handlePostUpdate=updatedPost=>{setPosts(prevPosts=>prevPosts.map(post=>post.id===updatedPost.id?{...post,...updatedPost}:post));updatePost(updatedPost.id,updatedPost);};const handlePostDelete=postId=>{setPosts(prevPosts=>prevPosts.filter(post=>post.id!==postId));deletePostFromContext(postId);setPagination(prev=>({...prev,total:prev.total-1}));};const handlePrevPage=()=>{if(page>1){setPage(page-1);}};const handleNextPage=()=>{if(page<pagination.totalPages){setPage(page+1);}};if(loading&&page===1){return/*#__PURE__*/_jsx(\"div\",{className:styles.loading,children:\"Cargando publicaciones...\"});}if(error){return/*#__PURE__*/_jsx(\"div\",{className:styles.error,children:error});}return/*#__PURE__*/_jsxs(\"div\",{className:styles[\"home-container\"],children:[/*#__PURE__*/_jsxs(\"h1\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Bienvenido, \",user.username]}),\"\\xBFQue hay de nuevo?\"]}),/*#__PURE__*/_jsx(\"div\",{className:styles[\"posts-container\"],children:posts.length>0?posts.map(post=>/*#__PURE__*/_jsx(Post,{post:post,onPostUpdate:handlePostUpdate,onPostDelete:handlePostDelete},post.id)):/*#__PURE__*/_jsx(\"p\",{children:\"No hay publicaciones disponibles. \\xA1Sigue a m\\xE1s usuarios o crea tu primera publicaci\\xF3n!\"})}),pagination.totalPages>1&&/*#__PURE__*/_jsxs(\"div\",{className:styles.pagination,children:[/*#__PURE__*/_jsx(\"button\",{className:styles[\"pagination-button\"],onClick:handlePrevPage,disabled:page===1||loading,children:\"Anterior\"}),/*#__PURE__*/_jsxs(\"div\",{className:styles[\"pagination-info\"],children:[\"P\\xE1gina \",page,\" de \",pagination.totalPages]}),/*#__PURE__*/_jsx(\"button\",{className:styles[\"pagination-button\"],onClick:handleNextPage,disabled:page===pagination.totalPages||loading,children:\"Siguiente\"})]})]});};export default Home;","map":{"version":3,"names":["useState","useEffect","useContext","axios","useAuth","AuthContext","Post","styles","jsx","_jsx","jsxs","_jsxs","Home","updatePost","deletePost","deletePostFromContext","user","posts","setPosts","loading","setLoading","error","setError","page","setPage","pagination","setPagination","limit","total","totalPages","fetchPosts","res","get","data","console","handlePostUpdate","updatedPost","prevPosts","map","post","id","handlePostDelete","postId","filter","prev","handlePrevPage","handleNextPage","className","children","username","length","onPostUpdate","onPostDelete","onClick","disabled"],"sources":["C:/Users/34615/Desktop/TFC_sys/ProyectoFinal_sys/client/src/pages/Home.jsx"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect, useContext } from \"react\"\nimport axios from \"axios\"\nimport { useAuth } from \"../context/AuthContext\"\nimport { AuthContext } from \"../context/AuthContext\"\nimport Post from \"../components/Post\"\nimport styles from \"../styles/Home.module.css\" // ⬅️ Importamos el módulo CSS\n\n\nconst Home = () => {\n  const { updatePost, deletePost: deletePostFromContext } = useContext(AuthContext)\n  const { user } = useAuth()\n  const [posts, setPosts] = useState([])\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState(\"\")\n  const [page, setPage] = useState(1)\n  const [pagination, setPagination] = useState({\n    page: 1,\n    limit: 5,\n    total: 0,\n    totalPages: 0,\n  })\n\n  useEffect(() => {\n    const fetchPosts = async () => {\n      try {\n        setLoading(true)\n        const res = await axios.get(`http://localhost:5000/api/posts?page=${page}&limit=5`)\n        setPosts(res.data.posts)\n        setPagination(res.data.pagination)\n        setLoading(false)\n      } catch (error) {\n        console.error(\"Error fetching posts:\", error)\n        setError(\"Error al cargar las publicaciones\")\n        setLoading(false)\n      }\n    }\n\n    fetchPosts()\n  }, [page])\n\n  const handlePostUpdate = (updatedPost) => {\n    setPosts((prevPosts) => prevPosts.map((post) => (post.id === updatedPost.id ? { ...post, ...updatedPost } : post)))\n    updatePost(updatedPost.id, updatedPost)\n  }\n\n  const handlePostDelete = (postId) => {\n    setPosts((prevPosts) => prevPosts.filter((post) => post.id !== postId))\n    deletePostFromContext(postId)\n    setPagination((prev) => ({\n      ...prev,\n      total: prev.total - 1,\n    }))\n  }\n\n  const handlePrevPage = () => {\n    if (page > 1) {\n      setPage(page - 1)\n    }\n  }\n\n  const handleNextPage = () => {\n    if (page < pagination.totalPages) {\n      setPage(page + 1)\n    }\n  }\n\n  if (loading && page === 1) {\n    return <div className={styles.loading}>Cargando publicaciones...</div>\n  }\n\n  if (error) {\n    return <div className={styles.error}>{error}</div>\n  }\n\n  return (\n    <div className={styles[\"home-container\"]}>\n      <h1>\n        <p>Bienvenido, {user.username}</p>¿Que hay de nuevo?\n      </h1>\n      <div className={styles[\"posts-container\"]}>\n        {posts.length > 0 ? (\n          posts.map((post) => (\n            <Post key={post.id} post={post} onPostUpdate={handlePostUpdate} onPostDelete={handlePostDelete} />\n          ))\n        ) : (\n          <p>No hay publicaciones disponibles. ¡Sigue a más usuarios o crea tu primera publicación!</p>\n        )}\n      </div>\n\n      {pagination.totalPages > 1 && (\n        <div className={styles.pagination}>\n          <button className={styles[\"pagination-button\"]} onClick={handlePrevPage} disabled={page === 1 || loading}>\n            Anterior\n          </button>\n          <div className={styles[\"pagination-info\"]}>\n            Página {page} de {pagination.totalPages}\n          </div>\n          <button\n            className={styles[\"pagination-button\"]}\n            onClick={handleNextPage}\n            disabled={page === pagination.totalPages || loading}\n          >\n            Siguiente\n          </button>\n        </div>\n      )}\n    </div>\n  )\n}\n\nexport default Home\n"],"mappings":"AAAA,YAAY,CAEZ,OAASA,QAAQ,CAAEC,SAAS,CAAEC,UAAU,KAAQ,OAAO,CACvD,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,OAAO,KAAQ,wBAAwB,CAChD,OAASC,WAAW,KAAQ,wBAAwB,CACpD,MAAO,CAAAC,IAAI,KAAM,oBAAoB,CACrC,MAAO,CAAAC,MAAM,KAAM,2BAA2B,CAAC;AAAA,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAG/C,KAAM,CAAAC,IAAI,CAAGA,CAAA,GAAM,CACjB,KAAM,CAAEC,UAAU,CAAEC,UAAU,CAAEC,qBAAsB,CAAC,CAAGb,UAAU,CAACG,WAAW,CAAC,CACjF,KAAM,CAAEW,IAAK,CAAC,CAAGZ,OAAO,CAAC,CAAC,CAC1B,KAAM,CAACa,KAAK,CAAEC,QAAQ,CAAC,CAAGlB,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACmB,OAAO,CAAEC,UAAU,CAAC,CAAGpB,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACqB,KAAK,CAAEC,QAAQ,CAAC,CAAGtB,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACuB,IAAI,CAAEC,OAAO,CAAC,CAAGxB,QAAQ,CAAC,CAAC,CAAC,CACnC,KAAM,CAACyB,UAAU,CAAEC,aAAa,CAAC,CAAG1B,QAAQ,CAAC,CAC3CuB,IAAI,CAAE,CAAC,CACPI,KAAK,CAAE,CAAC,CACRC,KAAK,CAAE,CAAC,CACRC,UAAU,CAAE,CACd,CAAC,CAAC,CAEF5B,SAAS,CAAC,IAAM,CACd,KAAM,CAAA6B,UAAU,CAAG,KAAAA,CAAA,GAAY,CAC7B,GAAI,CACFV,UAAU,CAAC,IAAI,CAAC,CAChB,KAAM,CAAAW,GAAG,CAAG,KAAM,CAAA5B,KAAK,CAAC6B,GAAG,CAAC,wCAAwCT,IAAI,UAAU,CAAC,CACnFL,QAAQ,CAACa,GAAG,CAACE,IAAI,CAAChB,KAAK,CAAC,CACxBS,aAAa,CAACK,GAAG,CAACE,IAAI,CAACR,UAAU,CAAC,CAClCL,UAAU,CAAC,KAAK,CAAC,CACnB,CAAE,MAAOC,KAAK,CAAE,CACda,OAAO,CAACb,KAAK,CAAC,uBAAuB,CAAEA,KAAK,CAAC,CAC7CC,QAAQ,CAAC,mCAAmC,CAAC,CAC7CF,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAEDU,UAAU,CAAC,CAAC,CACd,CAAC,CAAE,CAACP,IAAI,CAAC,CAAC,CAEV,KAAM,CAAAY,gBAAgB,CAAIC,WAAW,EAAK,CACxClB,QAAQ,CAAEmB,SAAS,EAAKA,SAAS,CAACC,GAAG,CAAEC,IAAI,EAAMA,IAAI,CAACC,EAAE,GAAKJ,WAAW,CAACI,EAAE,CAAG,CAAE,GAAGD,IAAI,CAAE,GAAGH,WAAY,CAAC,CAAGG,IAAK,CAAC,CAAC,CACnH1B,UAAU,CAACuB,WAAW,CAACI,EAAE,CAAEJ,WAAW,CAAC,CACzC,CAAC,CAED,KAAM,CAAAK,gBAAgB,CAAIC,MAAM,EAAK,CACnCxB,QAAQ,CAAEmB,SAAS,EAAKA,SAAS,CAACM,MAAM,CAAEJ,IAAI,EAAKA,IAAI,CAACC,EAAE,GAAKE,MAAM,CAAC,CAAC,CACvE3B,qBAAqB,CAAC2B,MAAM,CAAC,CAC7BhB,aAAa,CAAEkB,IAAI,GAAM,CACvB,GAAGA,IAAI,CACPhB,KAAK,CAAEgB,IAAI,CAAChB,KAAK,CAAG,CACtB,CAAC,CAAC,CAAC,CACL,CAAC,CAED,KAAM,CAAAiB,cAAc,CAAGA,CAAA,GAAM,CAC3B,GAAItB,IAAI,CAAG,CAAC,CAAE,CACZC,OAAO,CAACD,IAAI,CAAG,CAAC,CAAC,CACnB,CACF,CAAC,CAED,KAAM,CAAAuB,cAAc,CAAGA,CAAA,GAAM,CAC3B,GAAIvB,IAAI,CAAGE,UAAU,CAACI,UAAU,CAAE,CAChCL,OAAO,CAACD,IAAI,CAAG,CAAC,CAAC,CACnB,CACF,CAAC,CAED,GAAIJ,OAAO,EAAII,IAAI,GAAK,CAAC,CAAE,CACzB,mBAAOd,IAAA,QAAKsC,SAAS,CAAExC,MAAM,CAACY,OAAQ,CAAA6B,QAAA,CAAC,2BAAyB,CAAK,CAAC,CACxE,CAEA,GAAI3B,KAAK,CAAE,CACT,mBAAOZ,IAAA,QAAKsC,SAAS,CAAExC,MAAM,CAACc,KAAM,CAAA2B,QAAA,CAAE3B,KAAK,CAAM,CAAC,CACpD,CAEA,mBACEV,KAAA,QAAKoC,SAAS,CAAExC,MAAM,CAAC,gBAAgB,CAAE,CAAAyC,QAAA,eACvCrC,KAAA,OAAAqC,QAAA,eACErC,KAAA,MAAAqC,QAAA,EAAG,cAAY,CAAChC,IAAI,CAACiC,QAAQ,EAAI,CAAC,wBACpC,EAAI,CAAC,cACLxC,IAAA,QAAKsC,SAAS,CAAExC,MAAM,CAAC,iBAAiB,CAAE,CAAAyC,QAAA,CACvC/B,KAAK,CAACiC,MAAM,CAAG,CAAC,CACfjC,KAAK,CAACqB,GAAG,CAAEC,IAAI,eACb9B,IAAA,CAACH,IAAI,EAAeiC,IAAI,CAAEA,IAAK,CAACY,YAAY,CAAEhB,gBAAiB,CAACiB,YAAY,CAAEX,gBAAiB,EAApFF,IAAI,CAACC,EAAiF,CAClG,CAAC,cAEF/B,IAAA,MAAAuC,QAAA,CAAG,iGAAsF,CAAG,CAC7F,CACE,CAAC,CAELvB,UAAU,CAACI,UAAU,CAAG,CAAC,eACxBlB,KAAA,QAAKoC,SAAS,CAAExC,MAAM,CAACkB,UAAW,CAAAuB,QAAA,eAChCvC,IAAA,WAAQsC,SAAS,CAAExC,MAAM,CAAC,mBAAmB,CAAE,CAAC8C,OAAO,CAAER,cAAe,CAACS,QAAQ,CAAE/B,IAAI,GAAK,CAAC,EAAIJ,OAAQ,CAAA6B,QAAA,CAAC,UAE1G,CAAQ,CAAC,cACTrC,KAAA,QAAKoC,SAAS,CAAExC,MAAM,CAAC,iBAAiB,CAAE,CAAAyC,QAAA,EAAC,YAClC,CAACzB,IAAI,CAAC,MAAI,CAACE,UAAU,CAACI,UAAU,EACpC,CAAC,cACNpB,IAAA,WACEsC,SAAS,CAAExC,MAAM,CAAC,mBAAmB,CAAE,CACvC8C,OAAO,CAAEP,cAAe,CACxBQ,QAAQ,CAAE/B,IAAI,GAAKE,UAAU,CAACI,UAAU,EAAIV,OAAQ,CAAA6B,QAAA,CACrD,WAED,CAAQ,CAAC,EACN,CACN,EACE,CAAC,CAEV,CAAC,CAED,cAAe,CAAApC,IAAI","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}